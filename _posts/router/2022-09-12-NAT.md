---
title:  "NAT" 

categories:
  - router
tags:
  - [router,routing,nat]

toc: true

date: 2022-08-27
last_modified_at: 2022-08-27
---

## ğŸ—‚ï¸NAT

- <span style="color:blue"><b>NAT (Network Address Translation) </b></span>

  - ì£¼ì†Œ ë³€í™˜ ê¸°ìˆ 

  - ê³µì¸ IP ë¶€ì¡± í˜„ìƒì„ ì™„í™”í•˜ê¸° ìœ„í•´ ì œì•ˆëœ ê¸°ìˆ 

    > ì‚¬ì„¤ IPë¥¼ ì§€ì •í•˜ì—¬ intranet ë‚´ë¶€ì—ì„œë§Œ ì„ì˜ì˜ IPë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ 

    > ì¤‘ë³µëœ IPë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì‚¬ì„¤ IPë¥¼ ì´ìš©í•œ ê³µìš© ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ì œí•œ í•¨

    > intranetì—ì„œ ê³µìš© ë„¤íŠ¸ì›Œí¬ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” Routerì—ì„œ <span style="color:red"><b>ì‚¬ì„¤ IPë¥¼ ê³µì¸ IPë¡œ ë³€í™˜</b></span> ì‹œì¼œ ë‚´ë³´ë‚´ì•¼ í•¨

- <span style="color:blue"><b>NAT ì‚¬ìš© ëª©ì </b></span> 
  
  - IPv4 ë¶€ì¡±í˜„ìƒ ì™„í™”
  - ê³µì¸ IPì‚¬ìš© ë¹„ìš© ê°ì†Œ
  - ë³´ì•ˆ
  
- <span style="color:blue"><b>NAT ì¢…ë¥˜</b></span>

  - Static NAT

    > NAT Tableì˜ ë³€í™˜ ì •ë³´ë¥¼ ê´€ë¦¬ìê°€ ì§ì ‘ ì§€ì •í•˜ê³  ê´€ë¦¬ í•¨ â†’ ì •ë³´ê°€ ê³ ì • ë¨

    > <span style="color:red"><b>ì‚¬ì„¤ IP(1) : ê³µì¸ IP(1)</b></span>

    > Serverì— Clientê°€ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•¨

  - Dynamic NAT

    > NAT Tableì˜ ë³€í™˜ ì •ë³´ë¥¼ ì¥ë¹„ê°€ ì§ì ‘ ìƒì„±í•˜ê³  ê´€ë¦¬ í•¨ ï¼ NAT ë™ì‘ì„ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ì¡°ê±´ì— ë§ëŠ” Packetì„ ì „ë‹¬ë°›ì•˜ì„ ë•Œ ë³€í™˜ ë¨

    > <span style="color:red"><b>ì‚¬ì„¤ IP(n) : ê³µì¸ IP(m) </b></span>â†’ ë™ì‹œì— í†µì‹  ê°€ëŠ¥í•œ ì¥ë¹„ê°€ ê³µì¸ IPìˆ˜ë¡œ ì œí•œ ë¨

    > ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ì¥ë¹„ì˜ ê³µìš© ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ìœ„í•´ ì‚¬ìš© ë¨

  - NAT-PAT(Port Address Translation) 

    > ì¼ë°˜ Dynamic NATì˜ í•œê³„ë¥¼ ê·¹ë³µ ï¼ NATë™ì‘ì´ ìˆ˜í–‰ë  ë•Œ Portì£¼ì†Œë¥¼ ë³€í™˜ì •ë³´ ì‹ë³„ìš©ìœ¼ë¡œ í•¨ê»˜ ì‚¬ìš© í•¨

    > <span style="color:red"><b>ì‚¬ì„¤ IP(n) : ê³µì¸ IP(1) </b></span>â†’ í•˜ë‚˜ì˜ ê³µì¸ IPë¡œ ë‹¤ìˆ˜ì˜ ì‚¬ì„¤ IPë¥¼ ì´ìš©í•œ í†µì‹ ì´ ì§€ì› ë¨

## ğŸ—‚ï¸Static NAT

-  <span style="color:blue"><b>Static NAT</b></span>
  - ê³µì¸ IPë¡œ ì „ë‹¬ëœ Clientì˜ ìš”ì²­ì„ ë‚´ë¶€ Serverë¡œ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ ëª©ì ì§€ ì£¼ì†Œë¥¼ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥
  - Serverì— í• ë‹¹ëœ ì‚¬ì„¤ IP í•˜ë‚˜ë‹¹ ê³µì¸ IPë¥¼ í• ë‹¹ â†’ 1 : 1

![í™”ë©´ ìº¡ì²˜ 2022-09-12 170533](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 170533.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 170638](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 170638.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 170658](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 170658.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 170712](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 170712.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 170726](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 170726.png)

- <span style="color:blue"><b>Static NAT ì„¤ì •</b></span>

  - NAT ì •ì±… ì„¤ì •

    ```
    R1(config)# ip nat inside source static [ì‚¬ì„¤ IP] [ê³µì¸ IP]
    
    ```

  -  Interface ì—­í•  ê²°ì •

    > ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ â†’ inside

    ```
    R1(config)# interface [inside interface]
    R1(config-if)# ip nat inside
    ```

    > ê³µìš© ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ â†’ outside

    ```
    R1(config)# interface [outside interface]
    R1(config-if)# ip nat outside
    ```

- <span style="color:blue"><b>NAT ì •ë³´ í™•ì¸</b></span>

  - NAT Table ë³€í™˜ ì •ë³´ í™•ì¸

    ![í™”ë©´ ìº¡ì²˜ 2022-09-12 171848](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 171848.png)

  - NAT ì„¤ì • ì •ë³´ í™•ì¸

![í™”ë©´ ìº¡ì²˜ 2022-09-12 171916](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 171916.png)

- <span style="color:blue"><b>static nat ì‹¤ìŠµ</b></span>
  
  - êµ¬ì„±ë„
  
    ![í™”ë©´ ìº¡ì²˜ 2022-09-12 172901](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 172901.png)
  
  - ì¶œë°œì§€ IP ì£¼ì†Œ ë³€í™˜
  
    > í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ì— inside , outside ë¥¼ ì§€ì •
  
    ```
    NAT_Router(config)#int f1/0
    NAT_Router(config-if)#ip nat outside
    NAT_Router(config)#int f0/0
    NAT_Router(config-if)#ip nat inside
    ```
  
  - ì •ì±… ì„¤ì •
  
    > 192.168.1.100->1.1.1.100ìœ¼ë¡œ ì¶œë°œì§€ ì£¼ì†Œ ë³€í™˜
  
    ```
    NAT_Router(config)#ip nat inside source static 192.168.1.100 1.1.1.100
    ```
  
  - ì„¤ì • í™•ì¸
  
    ```
    NAT_Router#sh ip nat translations
    ```
  
    ![í™”ë©´ ìº¡ì²˜ 2022-09-12 174826](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 174826.png)
    
  - ì„¤ì • ì œê±°
  
    ```
    NAT_Router(config)#int f0/0
    NAT_Router(config-if)#no ip nat inside 
    
    NAT_Router(config-if)#int f1/0
    NAT_Router(config-if)#no ip nat outside 
    
    NAT_Router(config)#no ip nat inside source static 192.168.1.200 1.1.1.200
    NAT_Router(config)#no ip nat inside source static 192.168.1.100 1.1.1.100
    ```

## ğŸ—‚ï¸Dynamic NAT

- <span style="color:blue"><b>Dynamic NAT</b></span>
  - ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ ë‚´ë¶€ì˜ í˜¸ìŠ¤íŠ¸ í†µì‹ ì„ ìœ„í•´ ì‚¬ìš© ë¨
  - ë‹¤ìˆ˜ì˜ ì‚¬ì„¤ IPì˜ ì§€ì •ëœ ê°œìˆ˜ì˜ ê³µì¸ IPë¡œ ë³€í™˜ â†’ n : m (ë™ì‹œ í†µì‹  ê°€ëŠ¥ â†’ mëŒ€)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 175431](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 175431.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 175447](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 175447.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 175505](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 175505.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 175520](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 175520.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-12 175533](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 175533.png)

- <span style="color:blue"><b>Dynamic NAT ì„¤ì •</b></span>

  -  ì¡°ê±´ ì •ì±… ì„¤ì •

    > ì‚¬ì„¤ IP ë„¤íŠ¸ì›Œí¬ ì •ë³´ â†’ ACL

    ```
    R1(config)# access-list 1 permit [ì‚¬ì„¤ IP] [wildcard mask]
    
    ```

    > ë³€í™˜ì— ì‚¬ìš©í•  ê³µì¸ IP ì •ë³´ â†’ Pool

    ```
    R1(config)# ip nat pool [name] [start IP] [end IP] netmask [subnet mask]
    ```

  - NAT ì •ì±… ì„¤ì •

    ```
    R1(config)# ip nat inside source list [ACL number] pool [pool name]
    
    ```

  -  Interface ì—­í•  ê²°ì •

    > ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ â†’ inside

    ```
    R1(config)# interface [inside interface]
    R1(config-if)# ip nat inside
    ```

    > ê³µìš© ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ â†’ outside

    ```
    R1(config)# interface [outside interface]
    R1(config-if)# ip nat outside 
    ```

- <span style="color:blue"><b>Dynamic NAT ì‹¤ìŠµ</b></span>

  - êµ¬ì„±ë„

  - ![í™”ë©´ ìº¡ì²˜ 2022-09-12 180321](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-12 180321.png)

  - ê¸°ë³¸ ì„¤ì •

    ```
    NAT_Router(config)#int f0/0
    NAT_Router(config-if)#ip nat inside 
    NAT_Router(config-if)#int f1/0
    NAT_Router(config-if)#ip nat outside
    ```

  - acl(standard) : inside ë²”ìœ„ ì„¤ì •

    ```
    NAT_Router(config)#access-list 1 permit 192.168.1.0 0.0.0.255
    ```

  - pool :  outside ë²”ìœ„ ì„¤ì •

    ```
    NAT_Router(config)#ip nat pool dynat 1.1.1.100 1.1.1.101 netmask 255.0.0.0
    ```

  - acl(inside) -> pool(outside) ë¡œ ë³€í™˜

    ```
    NAT_Router(config)#ip nat inside source list 1 pool dynat
    ```

  - ì„¤ì • ì œê±°

    ```
    NAT_Router(config)#int f0/0
    NAT_Router(config-if)#no ip nat inside 
    NAT_Router(config-if)#int f2/0
    NAT_Router(config-if)#no ip nat inside 
    NAT_Router(config-if)#int f1/0
    NAT_Router(config-if)#no ip nat outside
    ```
  
    > access list 1ë²ˆ ì œê±° 
  
    ```
    NAT_Router(config)#no ip access-list standard 1
    NAT_Router(config)#do sh ip access-lists
    ```
  
    > ì‚­ì œì‹œ NAT ë³€í™˜ëª…ë ¹ì–´ ë¶€í„° í•´ì œ í›„ pool ì œê±°
  
    ```
    NAT_Router(config)#no ip nat pool dynat 1.1.1.100 1.1.1.101 netmask 255.0.0.0
    %Pool dynat in use, cannot destroy
    NAT_Router(config)#no ip nat inside source list 1 pool dynat
    NAT_Router(config)#no ip nat pool dynat 1.1.1.100 1.1.1.101 netmask 255.0.0.0
    ```

## ğŸ—‚ï¸NAT-PAT

- <span style="color:blue"><b>NAT-PAT(Port Address Translation)</b></span>
  - ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ ë‚´ë¶€ì˜ í˜¸ìŠ¤íŠ¸ í†µì‹ ì„ ìœ„í•´ ì‚¬ìš© ë¨
  - ë‹¤ìˆ˜ì˜ ì‚¬ì„¤ IPì˜ í•˜ë‚˜ì˜ ê³µì¸ IPë¡œ ë³€í™˜ â†’ n : 1
  - ì¼ë°˜ Dynamic NATì˜ í•œê³„ë¥¼ ê·¹ë³µ > pool ê°¯ìˆ˜ë§Œ ì‚¬ìš©ê°€ëŠ¥  
  - IPì£¼ì†Œê°€ ë¶€ì¡±í•œ ê²½ìš° í†µì‹ ì´ ë˜ì§€ ì•ŠëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ë°œìƒ ï¼ NAT ìˆ˜í–‰ì‹œ Portì£¼ì†Œë¥¼ ë³€í™˜ì •ë³´ ì‹ë³„ìš©(NAT Translation table)
  - ëŒ€í‘œì ì¸ ì‚¬ìš©ì˜ˆ  ì‚¬ì„¤ IP(n) : ê³µì¸ IP(1) â†’ í•˜ë‚˜ì˜ ê³µì¸ IPë¡œ ë‹¤ìˆ˜ì˜ ì‚¬ì„¤ IPë¥¼ ì´ìš©í•œ í†µì‹ ì´ ì§€ì› ë¨ inside ACL : outside interface  

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112130](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112130.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112147](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112147.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112200](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112200.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112302](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112302.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112314](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112314.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112332](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112332.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112349](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112349.png)

![í™”ë©´ ìº¡ì²˜ 2022-09-13 112410](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 112410.png)

- <span style="color:blue"><b>NAT-PAT ì„¤ì •</b></span>

  - ì¡°ê±´ ì •ì±… ì„¤ì •

    > ì‚¬ì„¤ IP ë„¤íŠ¸ì›Œí¬ ì •ë³´ â†’ ACL

    ```
    R1(config)# access-list 1 permit [ì‚¬ì„¤ IP] [wildcard mask]
    
    ```

    > ë³€í™˜ì— ì‚¬ìš©í•  ê³µì¸ IP ì •ë³´ â†’ Pool 

    ï¼ NAT ì •ì±… ì„¤ì •ì—ì„œ interfaceë¡œ ì§€ì •í•  ê²½ìš° ìƒëµ

    ```
    R1(config)# ip nat pool [name] [start IP] [end IP] netmask [subnet mask]
    ```

  - NAT ì •ì±… ì„¤ì •(ë‘ê°œ ì¤‘ í•˜ë‚˜ë§Œ ì„¤ì •) 

    > ê³µì¸ IP Pool ì„ ì´ìš©í•´ ì„¤ì • í•  ê²½ìš°

    ```
    R1(config)# ip nat inside source list [ACL number] pool [pool name] overload
    ```

  - ê³µì¸ IPê°€ ì„¤ì •ëœ Interfaceë¥¼ ì´ìš©í•´ ì„¤ì • í•  ê²½ìš°

    ```
    R1(config)# ip nat inside source list [ACL number] interface [outside interface]
    ```

  - Interface ì—­í•  ê²°ì •

    > ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ â†’ inside

    ```
    R1(config)# interface [inside interface]
    R1(config-if)# ip nat inside
    ```

    > ê³µìš© ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ â†’ outside

    ```
    R1(config)# interface [outside interface]
    R1(config-if)# ip nat outside
    ```

- <span style="color:blue"><b>NAT-PAT ì‹¤ìŠµ</b></span>

  - êµ¬ì„±ë„

    ![í™”ë©´ ìº¡ì²˜ 2022-09-13 114602](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 114602.png)

  - ê¸°ë³¸ì„¤ì •

    > ì¸í„°í˜ì´ìŠ¤ì— inside/outside

    ```
    NAT_Router(config)#int f0/0
    NAT_Router(config-if)#ip nat inside 
    NAT_Router(config-if)#int f1/0
    NAT_Router(config-if)#ip nat outside
    ```

  - acl(standard) : inside ë²”ìœ„ ì„¤ì •

    ```
    NAT_Router(config)#access-list 1 permit 192.168.1.0 0.0.0.255
    ```

  -  interface ì§€ì • : ACL(inside) -> interface ì˜ ì£¼ì†Œ (outside) ë¡œ ë³€í™˜

    ```
    NAT_Router(config)#ip nat inside source list 1 int f1/0 overload
    ```

  - í…ŒìŠ¤íŠ¸

    ```
    192.168.1.100 -> ping 1.1.1.2
    192.168.1.150 -> ping 1.1.1.2
    192.168.1.200 -> ping 1.1.1.2
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-13 114925](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-13 114925.png)



<br>

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}
