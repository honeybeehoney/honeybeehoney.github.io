---
title:  "VLAN" 

categories:
  - router
tags:
  - [router,routing,VLAN]

toc: true

date: 2022-08-27
last_modified_at: 2022-08-27
---

## ğŸ—‚ï¸VLAN (Virtual LAN)

- <span style="color:blue"><b>VLAN (Virtual LAN)</b></span>

  - L2 Switchë¶€í„° ì œê³µë˜ëŠ” ê°€ìƒì˜ LANì„ êµ¬ì„±í•˜ëŠ” ê¸°ëŠ¥

  - <span style="color:red"><b>ë…¼ë¦¬ì ì¸ ë„¤íŠ¸ì›Œí¬(Broadcast Domain) ë¶„ë¦¬ ê¸°ìˆ </b></span>

    > ë¬¼ë¦¬ì ì¸ ë¶„í•  â†’ ë¬¼ë¦¬ì ì¸ ì¥ë¹„(Router)ë¥¼ í†µí•œ ë¶„ë¦¬

  - ì‹ë³„ì(Number)ë¥¼ ì´ìš©í•˜ì—¬ Networkì´ë¦„ì„ ì§€ì •í•¨

  - Switch Portì— VLANì— ëŒ€í•œ ì •ë³´ë¥¼ ì„¤ì • í•¨

    > ì§€ì •ëœ portë¡œ ì „ë‹¬ë˜ëŠ” íŠ¸ë˜í”½ì— ì¶”ê°€ì •ë³´(VLAN)ë¥¼ Tagging í•¨

- <span style="color:blue"><b>VLAN ì‚¬ìš© ëª©ì </b></span>

  - <span style="color:red"><b>ë„¤íŠ¸ì›Œí¬(Broadcast Domain) ë¶„ë¦¬</b></span>

  - Broadcast Traffic ì¶•ì†Œ

  - ë³´ì•ˆ

    > ë„¤íŠ¸ì›Œí¬ê°€ ë¶„ë¦¬ë˜ë¯€ë¡œ ì •ì±…ì„ í†µí•´ í—ˆìš©ëœ ëŒ€ìƒë§Œ ì ‘ê·¼í•˜ê²Œ í•¨

  - ìœ ì—°ì„±

    > ê¸°ì¡´ topologyì˜ í° ë¬¼ë¦¬ì ì¸ ë³€í™”ê°€ ì—†ì–´ë„ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒ

## ğŸ—‚ï¸VLAN í• ë‹¹ ë°©ì‹

- <span style="color:blue"><b>Static VLAN </b></span>
  
  - <span style="color:red"><b>ê´€ë¦¬ìê°€ ì§ì ‘ ëª¨ë“  í¬íŠ¸ì— VLANì— ê´€ë ¨ëœ ì •ë³´ë¥¼ ì„¤ì •</b></span>
  - ê¸°ë³¸ì ì¸ ì„¤ì • ë°©ì‹(ê¶Œì¥)
  - ì¥ì  : í•œ ì¥ë¹„ì˜ ë¬¸ì œê°€ ì „ì²´ ë„¤íŠ¸ì›Œí¬ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠìŒ
  - ë‹¨ì  : ëª¨ë“  ê´€ë¦¬ì™€ ì„¤ì •ì„ ê´€ë¦¬ìê°€ ì§ì ‘ ìˆ˜í–‰í•´ì•¼ í•¨
  
- <span style="color:blue"><b>Dynamic VLAN</b></span>

  - VLAN í• ë‹¹ì„ ìˆ˜í–‰í•˜ëŠ” <span style="color:red"><b>ì™¸ë¶€ ì¥ë¹„(í”„ë¡œê·¸ë¨) ë“±ì„ ì‚¬ìš©í•˜ì—¬ VLANì— ê´€ë ¨ëœ ì •ë³´ë¥¼ ìë™ìœ¼ë¡œ ì„¤ì •</b></span>

    > VMPS(VLAN Membership Policy Server)

    > ì¥ë¹„ì˜ MAC ì£¼ì†Œ ê¸°ë°˜ìœ¼ë¡œ í•´ë‹¹ í¬íŠ¸ì— í• ë‹¹í•  VLANì •ë³´ë¥¼ ë¯¸ë¦¬ êµ¬ì„±í•¨ 

  - ì¥ì 

    > VLANì„ ì‚¬ìš©í•˜ëŠ” ì¥ë¹„ê°€ ì ‘ì†ë˜ì—ˆì„ ë•Œ ìë™ìœ¼ë¡œ VLAN ì •ë³´ê°€ ì„¤ì • ë¨

    > ì´ë™ì´ ì¦ì€ ì—…ë¬´ í™˜ê²½ì¼ ê²½ìš° íš¨ìœ¨ì ì„

  - ë‹¨ì 

    > VMPSì— ì¥ì• ê°€ ë°œìƒí•˜ë©´ VLANì„ ì´ìš©í•˜ëŠ” ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ì— ì¥ì• ê°€ ë°œìƒ í•¨

## ğŸ—‚ï¸VLAN PORT MODE

- <span style="color:blue"><b>VLAN PORT MODE</b></span>
  
  - VLANì´ ì„¤ì •ë˜ëŠ” Switch portì˜ ë™ì‘ ë°©ì‹ì„ ê²°ì •í•¨
  
- <span style="color:blue"><b>Access Port Mode</b></span>

  - í•˜ë‚˜ì˜ VLAN í†µì‹ ì„ ì§€ì›í•˜ëŠ” port 

    > access modeë¡œ ë™ì‘í•˜ëŠ” portì— vlan ë²ˆí˜¸ë¥¼ í• ë‹¹ í•¨

  - End deviceì™€ ì§ì ‘ ì—°ê²°ë˜ëŠ” port

  - VLAN ì •ë³´ë¥¼ ì œê±°í•˜ê³  ë°ì´í„° ì „ì†¡

![í™”ë©´ ìº¡ì²˜ 2022-09-16 094410](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-16 094410.png)



- <span style="color:blue"><b>Trunk Port Mode</b></span>

  - ì—¬ëŸ¬ VLAN íŠ¸ë˜í”½ì´ ì „ë‹¬ë  ìˆ˜ ìˆìŒ

    > ì„¤ì •ì„ í†µí•´ í—ˆìš©í•˜ëŠ” VLAN íŠ¸ë˜í”½ì„ ì œí•œí•  ìˆ˜ ìˆìŒ

  - Switchê°„/Routerì™€ ì—°ê²°ë˜ëŠ” portì— ì„¤ì •í•˜ëŠ” mode

    > ë™ì¼í•œ Tagging Protocolì´ ì„¤ì •ë˜ì–´ì•¼ í•¨

  - VLAN ì •ë³´ë¥¼ ë°ì´í„°ì™€ í•¨ê»˜ ì „ì†¡

![í™”ë©´ ìº¡ì²˜ 2022-09-16 094438](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-16 094438.png)

## ğŸ—‚ï¸VLAN Tagging Protocol

- <span style="color:blue"><b>TAG</b></span>

  - Switchë¥¼ í†µí•´ ì „ë‹¬ë˜ëŠ” ë°ì´í„°(Frame)ì— VLANì •ë³´ë¥¼ ì¶”ê°€í•˜ëŠ” ë™ì‘

  - ì¢…ë¥˜

    > í‘œì¤€ â†’ IEEE 802.1q (dot1q)(ê¶Œì¥)

    > cisco ì „ìš© â†’ ISL

- <span style="color:blue"><b>802.1q</b></span>
  
  - í”„ë ˆì„ í—¤ë”ì˜ Source Address ì™€ Type í•„ë“œ ì‚¬ì´ì— 4byte VLANì •ë³´ í•„ë“œë¥¼ ì¶”ê°€ í•¨
  - Native VLANì„ ì§€ì› í•¨ â†’ Taggingí•˜ì§€ ì•ŠëŠ” VLAN

![í™”ë©´ ìº¡ì²˜ 2022-09-16 105103](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-16 105103.png)

- <span style="color:blue"><b>ISL</b></span>

  - Ciscoì—ì„œ ê°œë°œí•œ Trunking Protocol

  - ì›ë³¸ í”„ë ˆì„ì˜ ë³€í˜• ì—†ì´ Encapsulationì„ í†µí•´ VLANì •ë³´ë¥¼ ë§ë¶™ì„

    > Encapsulation ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ì „ìš©ì˜ chipsetì„ ì‚¬ìš© â†’ ASIC(Application Specific Integrated  Circuits)

  - í™•ì¥ VALN, Native VLANì„ ì§€ì›í•˜ì§€ ì•ŠìŒ

![í™”ë©´ ìº¡ì²˜ 2022-09-16 105206](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-16 105206.png)

## ğŸ—‚ï¸Native VLAN

- <span style="color:blue"><b>Native VLAN</b></span>

  - VLAN ì •ë³´ê°€ ì—†ëŠ” í”„ë ˆì„ì„ ì „ì†¡í•˜ëŠ” VLAN

    > Tagging ë˜ì§€ ì•Šì€ ëª¨ë“  í”„ë ˆì„ì„ Switchì— ì„¤ì •ëœ Native VLANì˜ ì†Œì†ìœ¼ë¡œ ê°„ì£¼ í•¨

    > í”„ë ˆì„ì„ Tagging í•˜ì§€ ì•Šê³  Native VLANìœ¼ë¡œ ì§€ì •ëœ Portë¡œ ì „ë‹¬ í•¨ 

  - Tagì—†ì´ í†µì‹ í•˜ëŠ” VLAN

  - VLANì„ êµ¬ì„±í•œ ëª¨ë“  Switchì˜ Native VLANì˜ ë²ˆí˜¸ê°€ ì¼ì¹˜í•´ì•¼ í•¨ â†’ Looping ë°œìƒ

- <span style="color:blue"><b>ì‚¬ìš© ëª©ì </b></span>

  - Switchì™€ Hubê°€ ê°™ì´ ì‚¬ìš©ë˜ëŠ” í†µì‹  í™˜ê²½ì—ì„œ í˜¸í™˜ì„±ì„ ì œê³µ

    > Switch-Hub-Switchì—°ê²° êµ¬ê°„ì— Hubì— ì—°ê²°ëœ ì‚¬ìš©ìëŠ” Untagë˜ì§€ ì•Šì€ í”„ë ˆì„ì„ ì „ë‹¬ ë°›ìŒ

    > VLAN tagë¥¼ ì¸ì‹í•˜ì§€ ëª»í•˜ëŠ” hostëŠ” Ethernet Frameì˜ í˜•ì‹ì˜¤ë¥˜ë¼ ì¸ì‹í•˜ê³  ë°ì´í„°ë¥¼ íê¸°í•¨

    > Tagì—†ì´ í†µì‹ ì´ ê°€ëŠ¥í•œ VLANì´ í•„ìš”í•˜ê²Œ ë¨

  - Voice íŠ¸ë˜í”½ ì „ë‹¬

    > Tag, Untagì˜ ì‘ì—…ì˜ ë¶€í•˜ë¥¼ ì¤„ì—¬ì„œ ë°ì´í„° ì „ë‹¬ ì†ë„ë¥¼ í–¥ìƒ í•¨

## ğŸ—‚ï¸Access port mode ì‹¤ìŠµ

- <span style="color:blue"><b>êµ¬ì„±ë„</b></span>

  ![fdsa](../../assets/img/fdsa.png)

- <span style="color:blue"><b>ì„¤ì •í•˜ê¸°</b></span>

  - VLAN ìƒì„±

    ```
    Switch(config)#vlan 10
    Switch(config-vlan)#exit
    Switch(config)#vlan 20
    Switch(config-vlan)#exit
    Switch#sh vlan brief 
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-23 213528](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-23 213528-1663936657903-3.png)

  - switchport ì—ì„œ VLAN ì„ ì§€ì •

    ```
    Switch(config)#int f0/1
    Switch(config-if)#switchport mode access 
    Switch(config-if)#switchport access vlan 10
    
    Switch(config-if)#int f0/2
    Switch(config-if)#switchport mode access 
    Switch(config-if)#switchport access vlan 20
    
    Switch(config)#int f0/11
    Switch(config-if)#switchport mode access 
    Switch(config-if)#switchport access vlan 10
    
    Switch(config-if)#int f0/12
    Switch(config-if)#switchport mode access 
    Switch(config-if)#switchport access vlan 20
    
    Switch#sh vlan brief
    ```

    ![fdsafdsafdsa](../../assets/img/fdsafdsafdsa.png)

## ğŸ—‚ï¸Trunk port mode ì‹¤ìŠµ

- <span style="color:blue"><b>Trunk port mode ì˜ í•„ìš”ì„± </b></span>
  - ë§¤ë²ˆ VLAN ì´ ì¦ê°€í• ë•Œ ë§ˆë‹¤ ë§í¬ë¥¼ ëŠ˜ë¦¬ëŠ”ê²ƒì€ ë¬´ë¦¬ì´ë¯€ë¡œ ì—¬ëŸ¬ê°œì˜ VLAN frame  ì´ ë™ì‹œì— ì´ë™í• ìˆ˜ ìˆë„ë¡ í•˜ëŠ”ê²ƒ
- <span style="color:blue"><b>êµ¬ì„±ë„</b></span>

![í™”ë©´ ìº¡ì²˜ 2022-09-24 163312](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 163312.png)

- <span style="color:blue"><b>ì„¤ì •í•˜ê¸°</b></span>

  - ì™¼ìª½ ìŠ¤ìœ„ì¹˜

    ```
    SW_L(config-if)#switchport mode trunk
    SW_L(config-if)#switchport trunk allowed vlan 10,2
    ```

  - ì˜¤ë¥¸ìª½ ìŠ¤ìœ„ì¹˜

    ```
    SW_R(config)#int f0/24
    SW_R(config-if)#switchport mode trunk
    SW_R(config-if)#switchport trunk allowed vlan 10,20
    ```

  - trunk ì •ë³´ í™•ì¸

    ```
    SW_R#sh interfaces trunk
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 165141](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 165141.png)

  - access port ì •ë³´ í™•ì¸

    ```
    SW_R#sh interfaces f0/1 switchport
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 165342](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 165342.png)

  - trunk port ì •ë³´ í™•ì¸

    ```
    SW_R#sh interfaces f0/24 switchport
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 165537](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 165537.png)

## ğŸ—‚ï¸Native VLAN ì‹¤ìŠµ

- <span style="color:blue"><b>êµ¬ì„±ë„</b></span>

  ![í™”ë©´ ìº¡ì²˜ 2022-09-24 170209](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 170209.png)

- <span style="color:blue"><b>ì„¤ì •í•˜ê¸°</b></span>

  - ì™¼ìª½ ìŠ¤ìœ„ì¹˜

    ```
    SW_L(config)#int f0/7
    SW_L(config-if)#switchport mode access 
    SW_L(config-if)#switchport access vlan 77
    % Access VLAN does not exist. Creating vlan 77   -- ì—†ìœ¼ë©´ VLAN  ìë™ìƒì„±ë˜ë©´ì„œ ë“±ë¡
    
    SW_L(config-if)#switchport trunk native vlan 77
    SW_L(config-if)#switchport trunk allowed vlan add 77
    ```

  - ì˜¤ë¥¸ìª½ ìŠ¤ìœ„ì¹˜

    ```
    SW_R(config)#int f0/24
    SW_R(config-if)#switchport mode accessL
    SW_R(config-if)#switchport access vlan 77
    % Access VLAN does not exist. Creating vlan 77   -- ì—†ìœ¼ë©´ VLAN  ìë™ìƒì„±ë˜ë©´ì„œ ë“±ë¡
    
    SW_R(config-if)#switchport trunk native vlan 77
    SW_R(config-if)#switchport trunk allowed vlan add 77
    ```

  - trunk ì •ë³´ í™•ì¸

    ```
    SW_R#sh interfaces trunk
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 175100](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 175100.png)

## ğŸ—‚ï¸Inter VLAN

- <span style="color:blue"><b>Inter VLAN</b></span>

  - VLANìœ¼ë¡œ ë¶„ë¦¬ëœ Broadcast Domainê°„ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•¨

    > Multi Layer Switch ë˜ëŠ” Routingë¥¼ ì´ìš©í•˜ì—¬ VLANì„ Routing í•˜ëŠ” ê¸°ìˆ 

  - ì¡°ê±´ â†’ Routingê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ” ì¥ë¹„ê°€ í•„ìš” í•¨

-  <span style="color:blue"><b>Inter VLAN ë°©ì‹</b></span>

  - Routerë¥¼ ì´ìš©í•œ Inter VLAN

    > ë¬¼ë¦¬ì ì¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ë‚˜ëˆˆ sub interfaceë¥¼ ì´ìš©í•˜ì—¬ ì„¤ì •

    > Sub interface ì—ëŠ” Trunk ì„¤ì •ì´ ê°€ëŠ¥í•¨ â†’ í•˜ë‚˜ì˜ VLAN gatewayì„¤ì •ì´ ê°€ëŠ¥ í•¨

  - Multilayer Switchë¥¼ ì´ìš©í•œ Inter VLAN

    > L3 ê¸°ëŠ¥ì´ ì§€ì› ê°€ëŠ¥í•œ Switchë¥¼ ì´ìš©í•´ Routing ìˆ˜í–‰ 

    > SVI(Switch Virtual Interface) 

    â€‹	ï¼VLANì— ë…¼ë¦¬ì ìœ¼ë¡œ ì—°ê²°ë˜ëŠ” ê°€ìƒì˜ Interfaceë¥¼ ìƒì„±í•˜ì—¬ í†µì‹ ì„ ì§€ì›í•˜ëŠ” ë°©ì‹

    â€‹	ï¼ë‚´ë¶€ VLANì˜ Gatewayì„¤ì •ì— ì‚¬ìš© ë¨

    > Routed port

    â€‹	ï¼ë¬¼ë¦¬ì ì¸ L2 Portì— L3 ê¸°ëŠ¥ì„ í™œì„±í™” í•˜ì—¬ í†µì‹ ì„ ì§€ì›í•˜ëŠ” ë°©ì‹

    â€‹	ï¼Multilayer Switchê°„ì„ ì—°ê²°í•˜ê±°ë‚˜ Router, ì„œë²„ì™€ì˜ ì—°ê²°ì— ì‚¬ìš© ë¨

## ğŸ—‚ï¸Inter VLAN ì‹¤ìŠµ

- <span style="color:blue"><b>êµ¬ì„±ë„</b></span>

  ![í™”ë©´ ìº¡ì²˜ 2022-09-24 221252](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 221252.png)

- <span style="color:blue"><b>ì„¤ì •í•˜ê¸°</b></span>

  - VLAN ì„¤ì •

    ```
    L2_SW1(config)#vlan 10
    L2_SW1(config)#vlan 20
    
    L2_SW1#sh vlan br
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 223928](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 223928.png)

  - access mode

    ```
    L2_SW1(config)#int f0/1
    L2_SW1(config-if)#switchport mode access
    L2_SW1(config-if)#switchport access vlan 10
    
    L2_SW1(config-if)#int f1/1
    L2_SW1(config-if)#switchport mode access
    L2_SW1(config-if)#switchport access vlan 20
    
    L2_SW1#sh vlan br
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 224400](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 224400.png)

  - router ì„œë¸Œì¸í„°í˜ì´ìŠ¤ ì„¤ì •

    ```
    R1(config)#int f0/0.10
    R1(config-subif)#encapsulation dot1q 10
    R1(config-subif)#ip addr 192.168.10.254 255.255.255.0
    
    R1(config)#int f0/0.20
    R1(config-subif)#encapsulation dot1Q 20
    R1(config-subif)#ip addr 192.168.20.254 255.255.255.0
    
    R1(config-subif)#do sh ip int br
    ```

    ![image-20220924224806334](../../assets/img/image-20220924224806334.png)

  - switch portì— trunk ì„¤ì •

    ```
    L2_SW1(config)#int f2/1
    L2_SW1(config-if)#switchport mode trunk
    L2_SW1(config-if)#switchport trunk allowed vlan add 10
    L2_SW1(config-if)#switchport trunk allowed vlan add 20
    
    L2_SW1#sh interfaces trunk
    ```

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 225013](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 225013.png)

- <span style="color:blue"><b>test</b></span>

  - ping 192.168.10.100 -> 192.168.10.254

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 232303](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 232303.png)

  - ping 192.168.10.100 -> 192.168.20.254

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 232315](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 232315.png)

  - ping 192.168.10.100 -> 192.168.20.100

    ![í™”ë©´ ìº¡ì²˜ 2022-09-24 232327](../../assets/img/í™”ë©´ ìº¡ì²˜ 2022-09-24 232327.png)

<br>

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}